{"version":3,"sources":["theme/index.js","api/PollApi.js","components/Loader.js","api/MovieApi.js","components/MovieDetails.js","pages/PollScreen/index.js","App.js","serviceWorker.js","index.js"],"names":["theme","margin","x1","x2","BASE_SPACING","color","WHITE","BLACK","GREY","BLUE","BASE_URL","getPoll","a","fetch","response","json","data","simpleJsonToFormData","Object","keys","map","key","join","voteForPoll","answerId","body","method","headers","results","Container","styled","div","Loader","type","height","width","API_KEY","getMovieDetails","movieId","Title","h3","GenreLabel","p","Overview","MovieDetails","React","memo","useState","movie","setMovie","fetchMovie","useCallback","movieDetails","useEffect","title","genres","genre","name","overview","h1","AnswerContainer","props","isAnswer","AnswerLabel","LineContainer","InfoButton","selected","InfoButtonLabel","Spacer","PollScreen","poll","setPoll","setAnswerId","setResults","infoStates","setInfoStates","hasAnswered","fetchPoll","fetchedPoll","onAnswer","id","pollAnswers","answers","answer","onClick","num","denom","values","reduce","accu","curr","Math","round","getPercentage","App","exact","path","component","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message"],"mappings":"uSAEaA,EAAQ,CACnBC,OAAQ,CACNC,GAJiB,EAKjBC,GAAIC,IAENC,MAAO,CACLC,MAAO,UACPC,MAAO,UACPC,KAAM,OACNC,KAAM,YCXJC,EAAW,2CAGJC,EAAO,uCAAG,8BAAAC,EAAA,sEACEC,MAAM,GAAD,OAAIH,EAAJ,SADP,cACfI,EADe,gBAEFA,EAASC,OAFP,YAEfC,EAFe,kDAIZA,GAJY,iCAMZ,MANY,4CAAH,qDAUdC,EAAuB,SAACF,GAAD,OAC3BG,OAAOC,KAAKJ,GAAMK,KAAI,SAAAC,GAAG,gBAAOA,EAAP,YAAcN,EAAKM,OAAQC,KAAK,MAG9CC,EAAW,uCAAG,WAAOC,GAAP,mBAAAZ,EAAA,6DACnBa,EAAO,CAAED,YADU,SAEFX,MAAM,GAAD,OACvBH,EADuB,aAE1B,CACEgB,OAAQ,OACRC,QAAS,CACP,eAAgB,qCAElBF,KAAMR,EAAqBQ,KATN,cAEnBX,EAFmB,gBAYHA,EAASC,OAZN,cAYnBa,EAZmB,yBAalBA,GAbkB,2CAAH,sD,sMCZxB,IAEMC,EAAYC,IAAOC,IAAV,KAQFC,EAAS,kBACpB,kBAACH,EAAD,KACE,kBAAC,IAAD,CACEI,KAAK,OACL5B,MAAOL,EAAMK,MAAMI,KACnByB,OAfc,GAgBdC,MAhBc,OCDdC,EAAU,mCAYHC,EAAe,uCAAG,WAAOC,GAAP,iBAAA1B,EAAA,sEACNC,MAAM,GAAD,OAjBb,iCAiBa,OAfZ,UAeY,OAA2ByB,EAA3B,oBAA8CF,EAA9C,oBADC,cACvBtB,EADuB,gBAEVA,EAASC,OAFC,cAEvBC,EAFuB,yBAGtBA,GAHsB,2CAAH,sD,0RCX5B,IAAMuB,EAAQT,IAAOU,GAAV,IACAxC,EAAMK,MAAMC,OAGjBmC,EAAaX,IAAOY,EAAV,IACL1C,EAAMK,MAAMC,OAGjBqC,EAAWb,IAAOY,EAAV,IACH1C,EAAMK,MAAMC,OAIVsC,EAAeC,IAAMC,MAAK,YAAkB,IAAfR,EAAc,EAAdA,QAAc,EAC5BS,mBAAS,MADmB,mBAC/CC,EAD+C,KACxCC,EADwC,KAGhDC,EAAaC,sBAAW,uCAAC,WAAOb,GAAP,eAAA1B,EAAA,sEACFyB,EAAgBC,GADd,OACvBc,EADuB,OAE7BH,EAASG,GAFoB,2CAAD,sDAG3B,IAMH,OAJAC,qBAAU,WACRH,EAAWZ,KACV,CAACY,EAAYZ,IAETU,EACL,oCACE,kBAACT,EAAD,KAAQS,EAAMM,OACd,kBAACb,EAAD,KACGO,EAAMO,OAAOnC,KAAI,SAAAoC,GAAK,OAAIA,EAAMC,QAAMnC,KAAK,OAE9C,kBAACqB,EAAD,KAAWK,EAAMU,WAEjB,Q,0pCC/BN,IAAM7B,EAAYC,IAAOC,IAAV,IAIF/B,EAAMC,OAAOC,GACJF,EAAMK,MAAME,OAG5BgC,EAAQT,IAAO6B,GAAV,IACA3D,EAAMK,MAAMC,OAGjBsD,EAAkB9B,IAAOC,IAAV,IAGR/B,EAAMC,OAAOC,GACVF,EAAMC,OAAOC,GACVF,EAAMC,OAAOC,IACV,SAAA2D,GAClB,OAAQA,EAAMC,UACZ,KAAK,EACH,OAAO9D,EAAMK,MAAMI,KACrB,KAAK,EACH,OAAOT,EAAMK,MAAMG,KACrB,KAAK,KACL,QACE,OAAOR,EAAMK,MAAMC,UAOrByD,EAAcjC,IAAOY,EAAV,IACL1C,EAAMC,OAAOE,GAAQH,EAAMC,OAAOC,GAAQF,EAAMC,OAAOE,GAAQH,EAAMC,OAAOC,IAIlF8D,EAAgBlC,IAAOC,IAAV,KAKbkC,EAAanC,IAAOC,IAAV,KAOM,SAAA8B,GAAK,OAAIA,EAAMK,SAAWlE,EAAMK,MAAMI,KAAOT,EAAMK,MAAMG,OACnER,EAAMC,OAAOC,IAGnBiE,EAAkBrC,IAAOY,EAAV,KAIf0B,EAAStC,IAAOC,IAAV,KAMCsC,EAAa,WAAO,IAAD,EACNtB,mBAAS,MADH,mBACvBuB,EADuB,KACjBC,EADiB,OAEExB,mBAAS,MAFX,mBAEvBvB,EAFuB,KAEbgD,EAFa,OAGAzB,mBAAS,MAHT,mBAGvBnB,EAHuB,KAGd6C,EAHc,OAIM1B,mBAAS,IAJf,mBAIvB2B,EAJuB,KAIXC,EAJW,KAWxBC,IAAgBpD,EAEhBqD,EAAS,uCAAG,4BAAAjE,EAAA,sEACUD,IADV,OACVmE,EADU,OAEhBP,EAAQO,GAFQ,2CAAH,qDAKTC,EAAQ,uCAAG,WAAOC,GAAP,eAAApE,EAAA,6DACdgE,GAAeJ,EAAYQ,GADb,SAEWzD,EAAYyD,GAFvB,OAETC,EAFS,OAGfR,EAAWQ,GAHI,2CAAH,sDAMd5B,qBAAU,WACRwB,MACC,IAMH,OACEP,EACA,kBAAC,EAAD,KACE,kBAAC,EAAD,KAAQA,EAAKhB,OACZgB,EAAKY,QAAQ9D,KAAI,SAAA+D,GAAM,OACtB,kBAACnB,EAAD,CAAe3C,IAAG,iBAAY8D,EAAOH,KACnC,kBAACpB,EAAD,CACEwB,QAAS,kBAAML,EAASI,EAAOH,KAC/BlB,SAAUtC,EAAWA,IAAa2D,EAAOH,GAAK,MAC9C,kBAACjB,EAAD,KAAcoB,EAAO7B,OACrB,kBAACc,EAAD,MACCxC,EAAU,kBAACmC,EAAD,KAtCC,SAACiB,GACrB,IAAMK,EAAMzD,EAAQoD,GACdM,EAAQpE,OAAOqE,OAAO3D,GAAS4D,QAAO,SAACC,EAAMC,GAAP,OAAgBD,EAAOC,IAAM,GACzE,MAAM,GAAN,OAAUC,KAAKC,MAAMP,EAAMC,EAAQ,KAAnC,MAmCiCO,CAAcV,EAAOH,KAAqB,MAErE,kBAACf,EAAD,CAAYmB,QAAS,kBAjBRJ,EAiB0BG,EAAOH,QAhBpDL,EAAc,eAAKD,EAAN,eAAmBM,GAAMN,EAAWM,MAD/B,IAACA,GAiBsCd,SAAUQ,EAAWS,EAAOH,KAC7E,kBAACb,EAAD,eAILG,EAAKY,QAAQ9D,KAAI,SAAA+D,GAAM,OACtB,yBAAK9D,IAAG,eAAU8D,EAAOH,KAAON,EAAWS,EAAOH,KAAO,kBAACpC,EAAD,CAAcN,QAAS6C,EAAOH,UAG3F,kBAAC,EAAD,CAAQ/C,KAAK,OAAO5B,MAAM,UAAU6B,OAAQ,GAAIC,MAAO,MCjH5C2D,EARH,kBACV,kBAAC,IAAD,KACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAOC,OAAK,EAACC,KAAK,cAAcC,UAAW5B,OCK7B6B,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MACvB,2DCZNC,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,EAAD,OAEFC,SAASC,eAAe,SDyHpB,kBAAmBC,WACrBA,UAAUC,cAAcC,MACrBC,MAAK,SAAAC,GACJA,EAAaC,gBAEdC,OAAM,SAAAC,GACLC,QAAQD,MAAMA,EAAME,c","file":"static/js/main.72a59e38.chunk.js","sourcesContent":["const BASE_SPACING = 8;\n\nexport const theme = {\n  margin: {\n    x1: BASE_SPACING,\n    x2: BASE_SPACING * 2\n  },\n  color: {\n    WHITE: \"#FFFFFF\",\n    BLACK: \"#000000\",\n    GREY: 'grey',\n    BLUE: \"#00BFFF\",\n  }\n}","const BASE_URL = \"https://hidden-reef-75246.herokuapp.com/\";\n// const BASE_URL = \"http://localhost:5000/\";\n\nexport const getPoll = async () => {\n  const response = await fetch(`${BASE_URL}poll`);\n  const data = await response.json();\n  if (data) {\n    return data;\n  } else {\n    return null;\n  }\n}\n\nconst simpleJsonToFormData = (json) => (\n  Object.keys(json).map(key => `${key}=${json[key]}`).join(\"&\")\n);\n\nexport const voteForPoll = async (answerId) => {\n  const body = { answerId };\n  const response = await fetch(\n    `${BASE_URL}poll/vote`,\n    {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n      },\n      body: simpleJsonToFormData(body)\n    }\n  );\n  const results = await response.json();\n  return results;\n};\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport LoaderSpinner from 'react-loader-spinner'\nimport { theme } from \"../theme\";\n\nconst LOADER_SIZE = 80;\n\nconst Container = styled.div`\n  display: flex;\n  flex: 1;\n  justify-content: center;\n  align-items: center;\n  background-color: black;\n`;\n\nexport const Loader = () => (\n  <Container>\n    <LoaderSpinner\n      type=\"Bars\"\n      color={theme.color.BLUE}\n      height={LOADER_SIZE}\n      width={LOADER_SIZE}\n    />\n  </Container>\n)","const BASE_URL = \"https://api.themoviedb.org/3/\";\nconst SEARCH_MOVIE = \"search/movie\";\nconst GET_MOVIE = \"movie/\";\n\nconst API_KEY = \"f272a5f43ce4cc5810634ac04d30aa7d\";\n\nexport const searchMovie = async (queryString) => {\n  const response = await fetch(`${BASE_URL}${SEARCH_MOVIE}?api_key=${API_KEY}&language=fr-FR&page=1&include_adult=false&query=${queryString}`);\n  const data = await response.json();\n  if (data.results.length) {\n    return data.results[0];\n  } else {\n    return null;\n  }\n};\n\nexport const getMovieDetails = async (movieId) => {\n  const response = await fetch(`${BASE_URL}${GET_MOVIE}${movieId}?api_key=${API_KEY}&language=fr-FR`)\n  const data = await response.json();  \n  return data;\n};\n\n// export const getDetailsFromMovies = async (movieIds) => {\n//   const movies = await Promise.all(movieIds.map(getMovieDetails));\n//   console.warn(\"movies: \", movies);\n//   return movies;\n// };\n \n// const getImage = async (imageId) => {\n//   const response = await fetch(`https://image.tmdb.org/t/p/w600_and_h900_bestv2/${imageId}`);\n// };\n","import React, { useState, useEffect, useCallback } from 'react';\nimport { getMovieDetails } from \"../api/MovieApi\"\nimport styled from 'styled-components';\nimport { theme } from '../theme';\n\nconst Title = styled.h3`\n  color: ${theme.color.WHITE};\n`\n\nconst GenreLabel = styled.p`\n  color: ${theme.color.WHITE};\n`\n\nconst Overview = styled.p`\n  color: ${theme.color.WHITE};\n  text-align: justify;\n`\n\nexport const MovieDetails = React.memo(({ movieId }) => {\n  const [movie, setMovie] = useState(null);\n\n  const fetchMovie = useCallback(async (movieId) => {\n    const movieDetails = await getMovieDetails(movieId);\n    setMovie(movieDetails);\n  }, []);\n\n  useEffect(() => {\n    fetchMovie(movieId);\n  }, [fetchMovie, movieId]);\n\n  return movie ? (\n    <>\n      <Title>{movie.title}</Title>\n      <GenreLabel>\n        {movie.genres.map(genre => genre.name).join(', ')}\n      </GenreLabel>\n      <Overview>{movie.overview}</Overview>\n    </>\n  ) : null;\n});\n","import React, { useState, useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport { theme } from \"../../theme\";\nimport { getPoll, voteForPoll } from \"../../api/PollApi\"\nimport { Loader } from \"../../components/Loader\";\nimport { MovieDetails } from \"../../components/MovieDetails\";\n\nconst Container = styled.div`\n  display: flex;\n  flex: 1;\n  flex-direction: column;\n  padding: ${theme.margin.x1}px;\n  background-color: ${theme.color.BLACK};\n`;\n\nconst Title = styled.h1`\n  color: ${theme.color.WHITE};\n`;\n\nconst AnswerContainer = styled.div`\n  display: flex;\n  flex-grow: 1;\n  padding: ${theme.margin.x1}px;\n  margin-top: ${theme.margin.x1}px;\n  margin-bottom: ${theme.margin.x1}px;\n  background-color: ${props => {\n    switch (props.isAnswer) {\n      case true:\n        return theme.color.BLUE;\n      case false:\n        return theme.color.GREY;\n      case null:\n      default:\n        return theme.color.WHITE;\n    }\n  }};\n  border-radius: 8px;\n  max-width: 500px;\n`;\n\nconst AnswerLabel = styled.p`\n  margin: ${theme.margin.x2}px ${theme.margin.x1}px ${theme.margin.x2}px ${theme.margin.x1}px;\n  user-select: none;\n`;\n\nconst LineContainer = styled.div`\n  display: flex;\n  align-items: center;\n`\n\nconst InfoButton = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 40px;\n  width: 40px;\n  border-radius: 20px;\n  background-color: ${props => props.selected ? theme.color.BLUE : theme.color.GREY};\n  margin: ${theme.margin.x1}px;\n`\n\nconst InfoButtonLabel = styled.p`\n  user-select: none;\n`\n\nconst Spacer = styled.div`\n  display: flex;\n  flex: 1\n`\n\n\nexport const PollScreen = () => {\n  const [poll, setPoll] = useState(null);\n  const [answerId, setAnswerId] = useState(null);\n  const [results, setResults] = useState(null);\n  const [infoStates, setInfoStates] = useState({});\n  const getPercentage = (id) => {\n    const num = results[id];\n    const denom = Object.values(results).reduce((accu, curr) => accu + curr, 0);\n    return `${Math.round(num / denom * 100)} %`;\n  }\n\n  const hasAnswered = !!answerId;\n\n  const fetchPoll = async () => {\n    const fetchedPoll = await getPoll();\n    setPoll(fetchedPoll);\n  }\n\n  const onAnswer = async (id) => {\n    !hasAnswered && setAnswerId(id);\n    const pollAnswers = await voteForPoll(id);\n    setResults(pollAnswers);\n  }\n\n  useEffect(() => {\n    fetchPoll();\n  }, []);\n\n  const onInfoClick = (id) => {\n    setInfoStates({ ...infoStates, [id]: !infoStates[id] })\n  }\n\n  return (\n    poll ? \n    <Container>\n      <Title>{poll.title}</Title>\n      {poll.answers.map(answer => (\n        <LineContainer key={`answer-${answer.id}`}>\n          <AnswerContainer\n            onClick={() => onAnswer(answer.id)}\n            isAnswer={answerId ? answerId === answer.id : null}>\n            <AnswerLabel>{answer.title}</AnswerLabel>\n            <Spacer />\n            {results ? <AnswerLabel>{getPercentage(answer.id)}</AnswerLabel> : null}\n          </AnswerContainer>\n          <InfoButton onClick={() => onInfoClick(answer.id)} selected={infoStates[answer.id]}>\n            <InfoButtonLabel>i</InfoButtonLabel>\n          </InfoButton>\n        </LineContainer>\n      ))}\n      {poll.answers.map(answer => (\n        <div key={`info-${answer.id}`}>{infoStates[answer.id] && <MovieDetails movieId={answer.id} />}</div>\n      ))}\n    </Container> :\n    <Loader type=\"Bars\" color=\"#00BFFF\" height={80} width={80} />\n  )\n}\n","import React from \"react\";\nimport { Route, Switch, BrowserRouter as Router } from \"react-router-dom\";\nimport { PollScreen } from './pages/PollScreen';\n\nconst App = () => (\n  <Router>\n    <Switch>\n      <Route exact path=\"/movie-poll\" component={PollScreen} />\n    </Switch>\n  </Router>\n);\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}